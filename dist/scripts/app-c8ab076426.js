/******/!function(t){function e(n){if(a[n])return a[n].exports;var i=a[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}// webpackBootstrap
/******/
var a={};return e.m=t,e.c=a,e.p="",e(0)}([function(t,e,a){"use strict";var n=a(1),i=a(2),o=a(3),r=a(4),l=a(5),d=a(6),c=a(7),s=a(8),u=a(9),m=a(10);angular.module("tollminderAdmin",["ngSanitize","ngMessages","ui.router","ngMaterial","md.data.table","ngMap"]).constant("API","http://localhost:7000/api").constant("G_API_Key","AIzaSyA3bW45fzOFxRkt23VXQlG0W7Oy9Ud8M_g").config(n.config).config(i.routerConfig).run(o.runBlock).controller("RootController",r.RootController).controller("LoginController",l.LoginController).controller("RoadListController",d.RoadListController).controller("EntityController",c.EntityController).controller("DialogController",s.DialogController).service("LoginService",u.LoginService).service("CrudService",m.CrudService)},function(t,e){"use strict";function a(t,e,a){"ngInject";t.debugEnabled(!0),e.theme("default").primaryPalette("blue-grey"),a.interceptors.push()}a.$inject=["$logProvider","$mdThemingProvider","$httpProvider"],Object.defineProperty(e,"__esModule",{value:!0}),e.config=a},function(t,e){"use strict";function a(t,e){"ngInject";e.html5Mode=!0,t.state("login",{url:"/login",templateUrl:"app/views/login.html",controller:"LoginController",controllerAs:"ctrl"}).state("roadList",{url:"/",templateUrl:"app/views/roadList.html",controller:"RoadListController",controllerAs:"ctrl",data:{schema:[{title:"name",value:"",type:"text"}],child:"tollRoad"}}).state("tollRoad",{url:"/tollRoad/{_id}",templateUrl:"app/views/entity.html",controller:"EntityController",controllerAs:"ctrl",data:{schema:[{title:"name",value:"",type:"text"},{title:"latitude",value:0,type:"number"},{title:"longitude",value:0,type:"number"}],thead:["Way Point name","Latitude","Longitude"],tbody:["name","latitude","longitude"],child:"wayPoint",back:"home"}}).state("wayPoint",{url:"/wayPoint/{_id}",templateUrl:"app/views/entity.html",controller:"EntityController",controllerAs:"ctrl",data:{schema:[{title:"name",value:"",type:"text"},{title:"latitude",value:0,type:"number"},{title:"longitude",value:0,type:"number"},{title:"action",value:"exit",type:"select",options:["entrance","bridge","exit"]}],thead:["Toll Point name","Latitude","Longitude","Action"],tbody:["name","latitude","longitude","action"],child:"tollPoint"}}),e.otherwise("/")}a.$inject=["$stateProvider","$urlRouterProvider"],Object.defineProperty(e,"__esModule",{value:!0}),e.routerConfig=a},function(t,e){"use strict";function a(t,e,a){"ngInject";e.$on("$stateChangeSuccess",function(){localStorage.authToken||a.go("login")}),t.debug("runBlock end")}a.$inject=["$log","$rootScope","$state"],Object.defineProperty(e,"__esModule",{value:!0}),e.runBlock=a},function(t,e){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}();e.RootController=function(){function t(e){"ngInject";a(this,t),this.state=e}return t.$inject=["$state"],n(t,[{key:"logout",value:function(){localStorage.authToken="",this.state.go("login")}}]),t}()},function(t,e){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}();e.LoginController=function(){function t(e,n,i){"ngInject";a(this,t),this.state=n,this.Login=e,this.log=i,this.username="",this.password=""}return t.$inject=["LoginService","$state","$log"],n(t,[{key:"signin",value:function(){var t=this;this.form.$valid&&this.Login.auth(this.username,this.password).then(function(e){localStorage.authToken=e.data.token,t.state.go("roadList")})["catch"](function(e){return t.err=e.data.err})}}]),t}()},function(t,e){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}();e.RoadListController=function(){function t(e,n,i,o){"ngInject";a(this,t),this.dialog=e,this.log=n,this.CRUD=i,this.state=o,this.roads=[],this.limit=20,this.page=1,this.getRoads()}return t.$inject=["$mdDialog","$log","CrudService","$state"],n(t,[{key:"getRoads",value:function(){var t=this;this.CRUD.get("tollRoad").then(function(e){return t.roads=e.data})["catch"](this.log.debug)}},{key:"showModal",value:function(t){this.dialog.show({controller:"DialogController",controllerAs:"dialog",templateUrl:"app/views/modals/dialog.html",clickOutsideToClose:!0,bindToController:!0,locals:{data:t}})}},{key:"remove",value:function(t){var e=this,a=this.dialog.confirm().title("Are you sure?").textContent("Would you like to delete this road?").ok("Yes").cancel("No");this.dialog.show(a).then(function(){return e.CRUD.remove("tollRoad",t)}).then(function(){return e.state.reload()})["catch"](function(){return e.log.debug("canceled")})}}]),t}()},function(t,e){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}();e.EntityController=function(){function t(e,n,i,o,r,l,d){"ngInject";var c=this;a(this,t),this.dialog=e,this.log=n,this.state=o,this.CRUD=i,this.Map=r,this.Map.getMap().then(function(t){c.map=t}),this.googleMapsUrl="https://maps.google.com/maps/api/js?key="+d+"&libraries=places",this.pauseLoading=!0,l(function(){c.pauseLoading=!1},2e3),this.mappingField=null,this.data={},this.getEntity()}return t.$inject=["$mdDialog","$log","CrudService","$state","NgMap","$timeout","G_API_Key"],n(t,[{key:"getEntity",value:function(){var t=this;this.CRUD.get(this.state.current.name,this.state.params._id).then(function(e){e.data.hasOwnProperty("_wayPoints")&&(t.mappingField="_wayPoints"),e.data.hasOwnProperty("_tollPoints")&&(t.mappingField="_tollPoints"),t.data=e.data})["catch"](this.log.error)}},{key:"showModal",value:function(t){this.dialog.show({controller:"DialogController",controllerAs:"dialog",templateUrl:"app/views/modals/dialog.html",clickOutsideToClose:!0,bindToController:!0,locals:{data:t}})}},{key:"remove",value:function(t){var e=this,a=this.dialog.confirm().title("Are you sure?").textContent("Would you like to delete this "+this.state.current.data.child+"?").ok("Yes").cancel("No");this.dialog.show(a).then(function(){return e.CRUD.remove(e.state.current.data.child,t)}).then(function(){return e.state.reload()})["catch"](function(){return e.log.debug("canceled")})}}]),t}()},function(t,e){"use strict";function a(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}();e.DialogController=function(){function t(e,i,o,r,l,d,c){"ngInject";var s=this;n(this,t);var u=this;this.upd=this.data?!0:!1,this.dialog=e,this.CRUD=i,this.state=o,this.log=r,this.Map=l,this.googleMapsUrl="https://maps.google.com/maps/api/js?key="+c+"&libraries=places",this.pauseLoading=!0,d(function(){s.Map.getMap().then(function(t){s.map=t,s.pauseLoading=!1})},2e3),this.search="",this.schema=this.state.current.data.schema,this.document=a({},"_"+this.state.current.name,this.state.params._id),this.data&&(this.document._id=this.data._id),this.schema.map(function(t){return s.document[t.title]=s.data?s.data[t.title]:t.value}),this.clickOnMap=function(t){s.document.hasOwnProperty("latitude")&&(s.document.latitude=t.latLng.lat()),s.document.hasOwnProperty("longitude")&&(s.document.longitude=t.latLng.lng())},this.placeChanged=function(){u.place=this.getPlace(),u.document.latitude=u.place.geometry.location.lat(),u.document.longitude=u.place.geometry.location.lng()},this.log.debug(this.state.current.name)}return t.$inject=["$mdDialog","CrudService","$state","$log","NgMap","$timeout","G_API_Key"],i(t,[{key:"save",value:function(){var t=this;this.form.$valid&&this.CRUD.save(this.state.current.data.child,this.document,this.upd).then(function(e){t.log.debug(e),t.dialog.hide(),t.state.reload()})["catch"](this.log.error)}},{key:"hide",value:function(){this.dialog.hide()}}]),t}()},function(t,e){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}();e.LoginService=function(){function t(e,n){"ngInject";a(this,t),this.http=e,this.API=n}return t.$inject=["$http","API"],n(t,[{key:"auth",value:function(t,e){return this.http.post(this.API+"/user/adminAuth",{name:t,password:e})}}]),t}()},function(t,e){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}();e.CrudService=function(){function t(e,n){"ngInject";a(this,t),this.API=n,this.http=e}return t.$inject=["$http","API"],n(t,[{key:"save",value:function(t,e,a){return a?this.http.put(this.API+"/"+t+"/"+e._id,e):this.http.post(this.API+"/"+t+"/",e)}},{key:"get",value:function(t,e){return e?this.http.get(this.API+"/"+t+"/"+e):this.http.get(this.API+"/"+t)}},{key:"remove",value:function(t,e){return this.http["delete"](this.API+"/"+t+"/"+e)}}]),t}()}]),angular.module("tollminderAdmin").run(["$templateCache",function(t){t.put("app/views/entity.html",'<div class=wrapper><md-button ng-if="ctrl.state.current.name == \'tollRoad\'" ui-sref=roadList>to road list</md-button><md-button ng-if="ctrl.state.current.name == \'wayPoint\'" ui-sref="tollRoad({_id: ctrl.data._tollRoad._id})">to {{ctrl.data._tollRoad.name}}</md-button><div layout=row layout-align="space-between center"><div><h2><strong class=capitalize>{{ctrl.state.current.name}}</strong> : {{ctrl.data.name}}</h2><i>Created at: {{ctrl.data.createdAt | date}}</i><br><i ng-if=ctrl.data.updatedAt>Last update: {{ctrl.data.updatedAt | date}}</i></div><md-button class=create ng-click=ctrl.showModal()>Create new {{ctrl.state.current.data.child}}</md-button></div><hr><div class=loader ng-if=ctrl.pauseLoading layout=row layout-align="center center"><md-progress-circular md-mode=indeterminate md-diameter=70></md-progress-circular></div><div class=map ng-if=!ctrl.pauseLoading><div map-lazy-load=https://maps.google.com/maps/api/js map-lazy-load-params={{ctrl.googleMapsUrl}}><ng-map zoom=12 zoom-to-include-markers=auto disable-default-u-i=true center="{{ctrl.data[ctrl.mappingField][0].latitude}}, {{ctrl.data[ctrl.mappingField][0].longitude}}" on-click=ctrl.click()><marker ng-repeat="point in ctrl.data[ctrl.mappingField]" position="{{point.latitude}}, {{point.longitude}}" title={{point.name}}></marker></ng-map></div></div><hr><table md-table><thead md-head><tr md-row><th md-column ng-repeat="title in ctrl.state.current.data.thead"><span>{{title}}</span></th><th md-column md-numeric><span></span></th></tr></thead><tbody md-body><tr md-row ng-repeat="row in ctrl.data[ctrl.mappingField] track by row._id"><td md-cell ng-repeat="cell in ctrl.state.current.data.tbody" class=capitalize><a ng-href="{{ctrl.state.href(ctrl.state.current.data.child, {_id : row._id})}}" ng-if="cell == \'name\'">{{row[cell]}} </a><span ng-if="cell !== \'name\'">{{row[cell]}}</span></td><td md-cell><md-button class=md-icon-button ng-click=ctrl.showModal(row)><i class="fa fa-edit" aria-hidden=true></i></md-button><md-button class=md-icon-button ng-click=ctrl.remove(row._id)><i class="fa fa-trash-o" aria-hidden=true></i></md-button></td></tr></tbody></table></div>'),t.put("app/views/login.html",'<div class=wrapper><md-card><form name=ctrl.form ng-submit=ctrl.signin() novalidate><md-card-title><md-card-title-text layout=row layout-align="space-between center"><div class=md-headline>Login</div><div class=error ng-show=ctrl.err>{{ctrl.err}}</div></md-card-title-text></md-card-title><md-card-content><md-input-container><label>Username</label><input type=text name=username ng-model=ctrl.username required><div ng-messages=ctrl.form.username.$error><div ng-message=required>This field is required</div></div></md-input-container><md-input-container><label>Password</label><input type=password name=password ng-model=ctrl.password required><div ng-messages=ctrl.form.password.$error><div ng-message=required>This field is required</div></div></md-input-container></md-card-content><md-card-actions layout=row layout-align="end center"><md-button type=submit>Sign in</md-button></md-card-actions></form></md-card></div>'),t.put("app/views/roadList.html",'<div class=wrapper><div><md-button class=create ng-click=ctrl.showModal()>Create new Toll Road</md-button></div><table md-table><thead md-head><tr md-row><th md-column><span>Toll Road</span></th><th md-column md-numeric><span>Way Points</span></th><th md-column md-numeric><span></span></th></tr></thead><tbody md-body><tr md-row ng-repeat="road in ctrl.roads | limitTo: ctrl.limit: (ctrl.page - 1) * ctrl.limit"><td md-cell><a ui-sref="tollRoad({_id: road._id})">{{road.name}}</a></td><td md-cell>{{road._wayPoints.length}}</td><td md-cell><md-button class=md-icon-button ng-click=ctrl.showModal(road)><i class="fa fa-edit" aria-hidden=true></i></md-button><md-button class=md-icon-button ng-click=ctrl.remove(road._id)><i class="fa fa-trash-o" aria-hidden=true></i></md-button></td></tr></tbody></table><md-table-pagination md-limit-options=[20,35,50] md-limit=ctrl.limit md-page=ctrl.page md-total={{ctrl.roads.length}}></md-table-pagination></div>'),t.put("app/views/modals/dialog.html",'<md-dialog><form name=dialog.form ng-submit=dialog.save() novalidate><md-toolbar><div class=md-toolbar-tools><h3>{{dialog.upd ? "Update" : "Create new " + dialog.state.current.data.child }}</h3><span flex></span><md-button class=md-icon-button ng-click=dialog.hide()>&#10005</md-button></div></md-toolbar><md-dialog-content><div class=md-dialog-content><md-input-container ng-repeat="field in dialog.schema"><label class=capitalize>{{field.title}}</label><input ng-if="field.type != \'select\'" type={{field.type}} name={{field.title}} ng-class="" ng-model=dialog.document[field.title] ng-required="field.required || true"><md-select ng-if="field.type == \'select\'" ng-model=dialog.document[field.title] name={{field.title}} ng-required="field.required || true" class=capitalize><md-option ng-repeat="option in field.options" ng-value=option class=capitalize>{{option}}</md-option></md-select><div ng-messages=dialog.form[field.title].$error multiple md-auto-hide=true><div ng-message=required>This field required</div></div></md-input-container><div ng-if="dialog.state.current.name !== \'roadList\'"><div class=loader ng-if=dialog.pauseLoading layout=row layout-align="center center"><md-progress-circular md-mode=indeterminate md-diameter=70></md-progress-circular></div><md-input-container class=search-field><input type=text places-auto-complete component-restrictions="{country:\'ua\'}" types="[\'address\']" ng-model=dialog.search on-place-changed=dialog.placeChanged()></md-input-container><div class=map ng-if=!dialog.pauseLoading><div map-lazy-load=https://maps.google.com/maps/api/js map-lazy-load-params={{dialog.googleMapsUrl}}><ng-map zoom=12 zoom-to-include-markers=auto disable-default-u-i=true center={{dialog.search}} on-click=dialog.clickOnMap()><marker position="{{dialog.document.latitude}}, {{dialog.document.longitude}}" ng-if="dialog.document.latitude != 0 && dialog.document.longitude != 0" title={{dialog.document.name}}></marker></ng-map></div></div></div></div></md-dialog-content><md-dialog-actions class=modal-buttons layout=row><md-button ng-click=dialog.hide()>Cancel</md-button><md-button type=submit>Save</md-button></md-dialog-actions></form></md-dialog>')}]);
//# sourceMappingURL=../maps/scripts/app-c8ab076426.js.map
